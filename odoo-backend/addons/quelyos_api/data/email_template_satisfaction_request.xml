<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Template Email : Demande de Satisfaction apr√®s R√©solution -->
    <record id="email_template_satisfaction_request" model="mail.template">
        <field name="name">Demande de Satisfaction - Ticket R√©solu</field>
        <field name="model_id" ref="model_quelyos_ticket"/>
        <field name="subject">Votre ticket {{ object.name }} a √©t√© r√©solu - Donnez-nous votre avis</field>
        <field name="email_from">{{ (object.company_id.email or user.email_formatted) }}</field>
        <field name="email_to">{{ object.partner_id.email }}</field>
        <field name="description">Email automatique envoy√© au client apr√®s r√©solution d'un ticket pour collecter sa satisfaction</field>
        <field name="body_html" type="html">
<![CDATA[
<div style="margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f6f8;">
    <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
        <!-- Header -->
        <div style="background: linear-gradient(135deg, #0d9488 0%, #0f766e 100%); padding: 32px 24px; text-align: center;">
            <h1 style="margin: 0; color: #ffffff; font-size: 24px; font-weight: 600;">
                üéâ Votre ticket a √©t√© r√©solu !
            </h1>
        </div>

        <!-- Content -->
        <div style="padding: 32px 24px;">
            <p style="margin: 0 0 16px 0; color: #1f2937; font-size: 16px; line-height: 1.6;">
                Bonjour <strong>{{ object.partner_id.name }}</strong>,
            </p>

            <p style="margin: 0 0 16px 0; color: #1f2937; font-size: 16px; line-height: 1.6;">
                Bonne nouvelle ! Votre ticket <strong>{{ object.name }}</strong> concernant "<em>{{ object.subject }}</em>" a √©t√© r√©solu par notre √©quipe.
            </p>

            <div style="background-color: #f0fdfa; border-left: 4px solid: #0d9488; padding: 16px; margin: 24px 0; border-radius: 8px;">
                <p style="margin: 0 0 8px 0; color: #0f766e; font-weight: 600; font-size: 14px;">
                    R√©sum√© de votre ticket
                </p>
                <p style="margin: 0 0 4px 0; color: #374151; font-size: 14px;">
                    <strong>R√©f√©rence :</strong> {{ object.name }}
                </p>
                <p style="margin: 0 0 4px 0; color: #374151; font-size: 14px;">
                    <strong>Cat√©gorie :</strong> {{ dict(object._fields['category']._description_selection(object.env)).get(object.category) }}
                </p>
                <p style="margin: 0; color: #374151; font-size: 14px;">
                    <strong>R√©solu le :</strong> {{ format_datetime(object.resolution_date, dt_format='dd/MM/yyyy √† HH:mm', tz=object.partner_id.tz) if object.resolution_date else 'Aujourd\'hui' }}
                </p>
            </div>

            <p style="margin: 24px 0 16px 0; color: #1f2937; font-size: 16px; line-height: 1.6;">
                <strong>Nous aimerions conna√Ætre votre avis !</strong>
            </p>

            <p style="margin: 0 0 24px 0; color: #6b7280; font-size: 14px; line-height: 1.6;">
                Votre satisfaction est notre priorit√©. Prenez quelques secondes pour nous donner votre avis sur la r√©solution de votre demande.
            </p>

            <!-- CTA Button -->
            <div style="text-align: center; margin: 32px 0;">
                <a href="{{ ctx.get('satisfaction_url') }}"
                   style="display: inline-block; padding: 14px 32px; background: linear-gradient(135deg, #0d9488 0%, #0f766e 100%); color: #ffffff; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 16px; box-shadow: 0 4px 6px rgba(13, 148, 136, 0.3);">
                    ‚≠ê Donner mon avis
                </a>
            </div>

            <p style="margin: 24px 0 0 0; color: #9ca3af; font-size: 13px; text-align: center; line-height: 1.5;">
                Ce lien est valable pendant 30 jours. Votre avis nous aide √† am√©liorer la qualit√© de notre support.
            </p>
        </div>

        <!-- Footer -->
        <div style="background-color: #f9fafb; padding: 24px; text-align: center; border-top: 1px solid #e5e7eb;">
            <p style="margin: 0 0 8px 0; color: #6b7280; font-size: 13px;">
                Vous recevez cet email car votre ticket a √©t√© r√©solu.
            </p>
            <p style="margin: 0; color: #9ca3af; font-size: 12px;">
                ¬© {{ datetime.now().year }} {{ object.company_id.name or 'Quelyos' }}. Tous droits r√©serv√©s.
            </p>
        </div>
    </div>
</div>
]]>
        </field>
        <field name="auto_delete" eval="False"/>
        <field name="lang">{{ object.partner_id.lang }}</field>
    </record>
</odoo>
